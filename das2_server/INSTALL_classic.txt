==Installing the GenoPub DAS2 Server==

=== Modes ===
There are two ways to configure the GenoViz Genometry DAS2 server:
* Classic mode: The annotations are organized into a directory structure on the file system.  
* GenoPub mode: The annotations are managed by the GenoPub (Genomic Annotation Publisher), which stores information about each annotation in a database.  A web-based tool allows annotations to be easily added, described, and organized.  Through the tool, users and groups are managed and annotation security is specified. Access to annotations is brokered by the DAS2 server so that  only authorized users can gain access to these resources.    

Here are instructions for installing the DAS2 server in Classic mode. Any java servlet container will work.  Here we show how to do this with Tomcat.  Likewise most relational databases can be appropriately configured.  In this demonstration we are using MySQL. Lastly, these web apps were developed and run on Windows but since the majority of bioinformatics web servers use Linux, we use Red Hat Enterprise 5 in this tutorial.


=== System Requirements ===
* Java 6+, 64-bit recommended (http://java.sun.com/)
* Apache Tomcat 5.5+ (http://apache.tomcat.org/)
* Web accessible Linux, MacOSX, or Windows server with > 4G of RAM. This demo uses Red Hat Enterprize 5.



== Step 1: Check your java version ==
* Check that your java version is 6+ or 1.6+ by typing 'java -version' on the command line
* Download and install a new java if needed, http://java.sun.com/



== Step 2: Install and Configure Tomcat 5.5+ ==
* Make a new user called tomcat
* Login as tomcat
* Install Tomcat 5.5+ in the tomcat user's home directory, see http://tomcat.apache.org/download-55.cgi
* Add environmental variables to the tomcat user's ~/.bashrc file using a text editor

<pre>
#example for tomcat 5.5.25
export CATALINA_HOME=/home/tomcat/apache-tomcat-5.5.25
export JAVA_HOME=/usr
export JRE_HOME=/usr
#increase the memory available to tomcat, set to 4G or more if you have it, note 32bit machines can only us 2G
export CATALINA_OPTS=-Xmx4096m
</pre>

* Download the MySQL JDBC driver (MySQL Connector/J) from http://dev.mysql.com/downloads/connector/j/5.1.html.  Uncompress the zip file (mysql-connector-java-5.1.7.zip) and place the mysql-connector-java-5.1.7-bin.jar into your ~/apache-tomcat-5.xxx/common/lib directory. This is needed for java apps to connect to a MySQL database.
* Punch holes for port 8080 through any firewalls surrounding your computer
* Launch tomcat using the ~/apache-tomcat-5.xxx/bin/startup.sh script
* Verify that tomcat is visible by calling tomcat from a web browser http://yourComputersIP:8080/ . Ask someone off site to check it too.
* Shut down tomcat using the ~/apache-tomcat-5.xxx/bin/shutdown.sh script


== Step 3: Install the the GenoViz GenoPub DAS/2 Web app ==
* Download the latest beta das2server.zip archive from http://sourceforge.net/projects/genoviz/files/
* Unzip the archive 
* Move the entire das2 directory into ~apache-tomcat-5.xxx/webapps directory

== Step 4: Configure the GenoViz GenoPub DAS/2 Web app ==
* Modify the '~/das2/WEB-INF/web.xml' doc in a text editor
** Change the '/path/to/das2/data/' to the full path directory name where you want to store your data. 
** NOTE: The das2 servlet will need write access to the sub-directory /.indexed. This is used to store indexing files.  It is rebuilt upon a restart of the servlet.

** Create that data directory. 
** Change the 'admin@example.com' to point to a trusted admin
** Change the 'http://www.example.com:8080/das2/genome' replacing 'www.example.com:8080' with the URL for your machine. This is the same one you used to verify your tomcat installation.

* Modify the ~/das2/META-INF/context.xml doc in a text editor 
** Set the docBase and workdir in <Context> to the relative path of the webapp application. Example: <Context pathdocBase="webapps/das2" workDir="webapps/das2"debug="0" reloadable="true"> 







== Step 5: Launch it! ==
* Start up tomcat...
* From a browser, try a DAS/2 sources request: http://yourhost:8080/das2/genome . 
* The das2 servlet does not detect changes in the data directory.  The servlet must be reloaded before it will register any changes.

== Step 6: Register Your Das/2 Server ==
* Register your http://yourhost:8080/das2/genome URL, otherwise no one will know about your most excellent data.  Note only datasets you designate as public will be visable to non authenticated users.
* Currently, the [http://www.dasregistry.org DasRegistry] does not support DAS/2 services.  As a temporary work around, download the 'das2Registry.xml' file from the [http://genoviz.svn.sourceforge.net/viewvc/genoviz/trunk/das2_server/resources/ GenoViz Project], add an entry, and email it back to the [mailto:genoviz-devel@lists.sourceforge.net  GenoViz developers] . If you have access to the GenoViz SVN, modify it directly. 


== Step 7: Visualize your data in IGB ==
* The [[Software:IGB Integrated Genome Browser]] is fully DAS/2 and DAS/1 compliant and a good application for visualizing your genomic data.  
* Launch IGB using the web start links 
* Under the 'Data Access' tab, click the 'Configure...' button and add your server:
** Server URL 'http://yourhost:8080/das2/genome'
** Server name 'YourOrg'
** Server type 'DAS2'
** Login (leave blank)
** Password (leave blank)
* Click the 'Add' button, a confirmatory message should appear
* Under the 'Data Access' tab, select a Species and a Genome Version where your data resides


Please send comments to xxxx if you encounter install issues or needed corrections.

