/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package apollo.analysis;
import apollo.datamodel.Sequence;
import apollo.datamodel.StrandedFeatureSet;
import apollo.datamodel.StrandedFeatureSetI;
import org.junit.Test;

/**
 *
 * @author tkanapar
 */
public class RemoteBlastNCBITest {
    private final RemoteBlastNCBI.BlastType blastType = RemoteBlastNCBI.BlastType.blastx;//can be resued for blastp
    StrandedFeatureSetI sf = new StrandedFeatureSet();
    String id ="null chr1:9,416-11,422 + A_thaliana_Jun_2009 [Arabidopsis thaliana]";
    String sequence = "GAAGTTTCCTTATCATCATTAATCATGCCTATGAAAACCCTAACCGGCCTACATATTTGCAGTCTCTTTTAGGTCAGGAATCTAATGAGAATGAATTATTTTATTTTATTTAACAATAATTGGAGCATGTCATTAATTCTCTTTATTCTTCTTACACAACTAATCATTTAGATGTGTTACAATATTATTTCCTTTAGTCATTTTCATAATTTTAATACCTCCGTACTTTTCACTAATACCTCCCCTTTTAATTTTCATTATTTCTTCTTTTCTATCAGTCTATGCATGCATTCTTTTGAATATTAAAATGCATTTTATATTCTTTTGACAACTATGCACAAGCCTTTTGAGACACATCTACACAATATAATAGCACAAGCCTTTATGAGACATATCTACACAATATCATTGCTACTTGTAGACTATTTGGAATACGTATTTACATATTCCATTGTATCATCCCTTTGCAAATGTTTTATACATATAACTAACATATACATTATTCGTAACTTTGTTCCCCTATATCGAAAAATGTGGGCTACACATATAACTAACATATATATATATATGTATGTTTATATGATATAGTCTCCATGTCTATATATCTTATATATTACATGTTTCATGTTTACGGTCAAGGGAGTATTTTTATACGCATACACAATCATACACACTTAACCCTACTTATAATGATGTAGGTTCATATATTTATCTTATTTTAGGATCATTCGATCACAAATTATACGGACCCTCATACTCTCTAAAGATATACAAAATCCGCTATGTCATATCCGATCCGAATTAGCAGCTAAAGAAAAACAAACACATGCATCTACTGAAGATTTGAGTCTCGAGTGCTTAGTTACATGAACTATCACAAAGGATATGGATAATATAAGGTGTACTGAAGTATGTCTATGCAATGGGAGGGAAATACATTCTGTTAAATGACTTGTCGATTTGATCTTTCATGCCAAAGATTAAAAATTTAACACTTAATTAACGCAATCTTACCATATATTCATGGACTACATGCAGAATAGTAATTCTCCCAACCTTTCTAGTTATTTACCTGAATGTGTTTATGTACATGGACCGGTAACCTCATGTATATATGCACATACTGACAATCTGACATACATATATATAGTAGATATGACAACAACAACAAAAAAAAAAAAAATTCCTTGTTCGTGAAGCATGATCTGAGAGTTCCTAGTTAGCATGTTGTGTGGGATCATACTTTTAATATGCTGCAAGTACCAGTCAATTTTAGTATGGGAAACTATAAACATGTATAATCAACCAATGAACACGTCAATAACCTATTGAACAGCTTAGGGTGAAAATTATGATCCGTAGAGACAGCATTTAAAAGTTCCTTACGTCCACGTAAAATAATATATCAATTTATACATATACATGTGTAAACTGTGTATATATAGGGTAGGTATATGTGTATATATATAGTAATTGACAAATGATTTAGGTTCTAACATATATTCTAAAAGTACTCATGAGTTTGTGAGATCTACACAAGATACCTGATTTGATAAAAATGGCTTCAACTTGCAATCCAAACCAAACCAAACAAAGTTAATAACCAAGGGTTAATAACAAAAACAAGAATCTAGAATTAGTAAAAAAATGAGAAATTAATGAACCTGTGATCATAAAAAAAGTCAAACAATGTGAAAACATATCATACCTTTTGTTCTTTTTAATATAATAATTGAATTACTAAATGGATGGATCAGTCCTTCTTCCATAGCTAGCTTCTCTTTATTTTCTCTGCCCATAACCTGCAGAAAATCTCTTTAACCGAGCAAAATTACAAGAGTAACCAAACAAACAAAATAGGACCATCAGAGAGAGAGAAAAGAGTGCCTTTTTTTGGACCTGCCCATTAGCTTAGAATGTACCATGAAACACTTTGTCAGTGTAGGGAGATAGGCACAGAGAGTACAATTCATGAAATTTATAAGCTTTTTTCCCACTCATCAATT";
    
    
    @Test
    public void checkRunAnalysis() throws Exception{
        RemoteBlastNCBI blast = new RemoteBlastNCBI(blastType, new RemoteBlastNCBI.BlastOptions());
        Sequence seq = new Sequence(id, sequence.substring(0,51));
        String url = blast.runAnalysis(sf, seq, 1);
        System.out.println(url);
    }
    
}
