<?xml version="1.0" encoding="UTF-8"?>
<project basedir=".." name="IGB-IDE">
	<import file="../build.xml"/>
	<target depends="demos" name="run-selected-file-in-src">
		<fail unless="run.class">Must set property 'run.class'</fail>
		<java classname="${run.class}" failonerror="true" fork="true">
			<classpath>
				<pathelement path="core/genoviz_sdk/demo"/>
				<fileset dir="${lib.dir}" includes="*.jar"/>
				<dirset dir="${basedir}/core">
					<include name="*/build"/>
				</dirset>
			</classpath>
		</java>
	</target>
	<!-- TODO: edit the following target according to your needs -->
	<!-- (more info: http://www.netbeans.org/kb/articles/freeform-config.html#compilesingle) -->
	<target name="compile-selected-files-in-src">
		<fail unless="files">Must set property 'files'</fail>
		<mkdir dir="das2_server/build"/>
		<javac destdir="das2_server/build" includes="${files}" source="1.5" srcdir="core/igb/src">
			<classpath path="ext/javax.servlet.jar:ext/org.mortbay.jetty.jar:core/genometryImpl/src:ext/image4j.jar:ext/affx_fusion.jar:ext/freehep-2.1.1.jar:ext/commons-codec-1.4.jar:ext/catalina.jar:ext/cos.jar:ext/dom4j-1.6.1.jar:ext/hibernate3.jar:core/genoviz_sdk/src:ext/commons-compress-1.6.jar:ext/commons-net-2.0.jar:ext/sam.jar:ext/picard.jar:ext/colt.jar:ext/junit.jar:ext/jide-common.jar:ext/jide-components.jar:ext/jide-grids.jar:ext/felix.jar:ext/tabix.jar:plugins/plugins_page/lib/org.apache.felix.bundlerepository-1.6.4.jar:plugins/plugins_page/lib/org.osgi.service.obr-1.0.2.jar:igb_server/lib/bindex.jar:igb_server/lib/commons-fileupload-1.2.2.jar:igb_server/lib/commons-io-2.0.jar:ext/swing-layout-1.0.4.jar"/>
		</javac>
	</target>
	<!-- TODO: edit the following target according to your needs -->
	<!-- (more info: http://www.netbeans.org/kb/articles/freeform-config.html#runsingle) -->
	<target name="debug-selected-file-in-src">
		<fail unless="debug.class">Must set property 'debug.class'</fail>
		<ant antfile="build.xml" inheritall="false">
			<target name="compile"/>
			<target name="classpath"/>
		</ant>
		<path id="cp">
			<pathelement path="ext/javax.servlet.jar:ext/org.mortbay.jetty.jar:ext/image4j.jar:ext/affx_fusion.jar:ext/freehep-2.1.1.jar:ext/commons-codec-1.4.jar:ext/catalina.jar:ext/cos.jar:ext/dom4j-1.6.1.jar:ext/hibernate3.jar:ext/commons-compress-1.6.jar:ext/commons-lang3-3.1.jar:ext/commons-net-2.0.jar:ext/sam.jar:ext/picard.jar:ext/colt.jar:ext/junit.jar:ext/jide-common.jar:ext/jide-components.jar:ext/jide-grids.jar:ext/felix.jar:ext/jython.jar:ext/swing-layout.jar:ext/BigWig.jar:ext/be.pwnt.jflow_1.0.0.jar:ext/jdom-1.1.3.jar:ext/tribble.jar:ext/jdom.jar:ext/HCIDictionary.jar:ext/gnomex.jar:ext/hci_framework.jar:ext/Hibernate3Utils.jar:ext/gnomex_realm.jar:ext/hci_utils.jar:ext/lambdaj-2.4-with-dependencies.jar:ext/JGoogleAnalytics_0.4.jar:plugins/plugins_page/lib/org.apache.felix.bundlerepository-1.6.6.jar:plugins/plugins_page/lib/org.osgi.service.obr-1.0.2.jar:plugins/Tutorial/lib/furbelow.jar:plugins/Tutorial/lib/jackson-all-1.7.9.jar:plugins/TableView/lib/TableView.jar:plugins/PythonScript/lib/jython.jar:plugins/RubyScript/lib/asm-2.2.3.jar:plugins/RubyScript/lib/backport-util-concurrent.jar:plugins/RubyScript/lib/jruby-engine.jar:plugins/RubyScript/lib/jruby.jar:plugins/ThousandGenomesServerType/lib/commons-io-2.4.jar:plugins/SearchModeLucene/lib/commons-httpclient-3.1.jar:plugins/SearchModeLucene/lib/commons-vfs2-2.0.jar:plugins/SearchModeLucene/lib/concurrent.jar:plugins/SearchModeLucene/lib/lucene-core-3.6.0.jar:plugins/HeatmapEditor/lib/swingx-all-1.6.4.jar"/>
			<pathelement location="das2_server/build"/>
			<pathelement location="core/genometryImpl/build"/>
			<pathelement location="core/genoviz_sdk/build"/>
			<pathelement location="core/igb/build"/>
			<pathelement location="core/genoviz_sdk/demo"/>
			<pathelement location="core/main/build"/>
			<pathelement location="core/common/build"/>
			<pathelement location="plugins/ExternalView/build"/>
			<pathelement location="core/igb_service/build"/>
			<pathelement location="plugins/plugins_page/build"/>
			<pathelement location="plugins/RestrictionSites/build"/>
			<pathelement location="core/window_service/build"/>
			<pathelement location="plugins/window_service_def/build"/>
			<pathelement location="plugins/PropertyView/build"/>
			<pathelement location="plugins/SearchView/build"/>
			<pathelement location="plugins/GraphAdjuster/build"/>
			<pathelement location="bundles"/>
			<pathelement location="plugins/Tutorial/build"/>
			<pathelement location="plugins/TableView/build"/>
			<pathelement location="plugins/HeatmapEditor/build"/>
		</path>
		<nbjpdastart addressproperty="jpda.address" name="IGB" transport="dt_socket">
			<classpath refid="cp"/>
		</nbjpdastart>
		<java classname="${debug.class}" fork="true">
			<classpath refid="cp"/>
			<jvmarg value="-Xdebug"/>
			<jvmarg value="-Xrunjdwp:transport=dt_socket,address=${jpda.address}"/>
		</java>
	</target>
	<target name="test-genometryImpl" description="Run individual Unit tests" depends="compile">
		<fail unless="testclass">Must set property 'classname'</fail>
		<loadproperties srcFile="core/genometryImpl/ant.properties"/>
		<mkdir dir="core/genometryImpl/build-test"/>
		<javac srcdir="core/genometryImpl/test" includeantruntime="false" destdir="core/genometryImpl/build-test" classpath="${junit.jar}:${test.classpath}">
			<compilerarg  value="-Xlint:none" />
		</javac>
		<path id="cp">
			<pathelement path="${junit.jar}:${test.classpath}" />
			<dirset dir="core/genometryImpl/test/resources">
				<include name="**/*"/>
			</dirset>		
		</path>
		<junit errorProperty="test.failed" failureproperty="test.failed" fork="yes" haltonfailure="yes" printsummary="yes" showoutput="yes">
			<jvmarg value="-Djava.awt.headless=true"/>
			<formatter type="plain" usefile="false"/>
			<classpath refid="cp"/>
			<test name="${testclass}" todir="core/genometryImpl/build-test"/>
			
		</junit>
		<fail if="test.failed" message="Tests failed!"/>
	</target>
	<target name="test-das2Server" description="Run individual Unit tests" depends="compile">
		<fail unless="testclass">Must set property 'classname'</fail>
		<loadproperties srcFile="das2_server/ant.properties"/>
		<mkdir dir="das2_server/build-test"/>
		<javac srcdir="das2_server/test" destdir="das2_server/build-test" includeantruntime="false" classpath="${junit.jar}:${test.classpath}">
			<compilerarg  value="-Xlint:none" />
		</javac>
		<path id="cp">
			<pathelement path="${junit.jar}:${test.classpath}" />
			<dirset dir="das2_server/test/resources">
				<include name="**/*"/>
			</dirset>		
		</path>
		<junit errorProperty="test.failed" failureproperty="test.failed" fork="yes" haltonfailure="yes" printsummary="yes" showoutput="yes">
			<jvmarg value="-Djava.awt.headless=true"/>
			<formatter type="plain" usefile="false"/>
			<classpath refid="cp"/>
			<test name="${testclass}" todir="das2_server/build-test"/>
			
		</junit>
		<fail if="test.failed" message="Tests failed!"/>
	</target>
	<target name="test-bookmarks" description="Run individual Unit tests" depends="compile">
		<fail unless="testclass">Must set property 'classname'</fail>
		<loadproperties srcFile="plugins/Bookmark/ant.properties"/>
		<mkdir dir="plugins/Bookmark/build-test"/>
		<javac srcdir="plugins/Bookmark/test" destdir="plugins/Bookmark/build-test" includeantruntime="false" classpath="${junit.jar}:${test.classpath}">
			<compilerarg  value="-Xlint:none" />
		</javac>
		<path id="cp">
			<pathelement path="${junit.jar}:${test.classpath}" />
			<dirset dir="plugins/Bookmark/test/resources">
				<include name="**/*"/>
			</dirset>		
		</path>
		<junit errorProperty="test.failed" failureproperty="test.failed" fork="yes" haltonfailure="yes" printsummary="yes" showoutput="yes">
			<jvmarg value="-Djava.awt.headless=true"/>
			<formatter type="plain" usefile="false"/>
			<classpath refid="cp"/>
			<test name="${testclass}" todir="plugins/Bookmark/build-test"/>
			
		</junit>
		<fail if="test.failed" message="Tests failed!"/>
	</target>
</project>
